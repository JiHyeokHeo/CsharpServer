# CsharpServer

## 목차
- [서버란 무엇일까](#서버란-무엇일까?)
- [게임 서버의 종류](#게임-서버의-종류)
  - [웹 서버](#웹-서버)
  - [게임 서버](#게임-서버)
- [멀티쓰레드](#멀티쓰레드)
- [네트워크](#네트워크)
- [DB](#DB)
- [게임 로직](#게임-로직)
- [서버 구조](#서버-구조)
<br/> 
  
## 서버란 무엇일까
__다른 컴퓨터에서 연결이 가능하도록 대기 상태로 상시 실행중인 프로그램__  
__영업중인 식당__ 과 유사함.
 - 손님이 올 수 있도록 식당을 열고 대기중인 상태
 - 손님이 오면 식당 메뉴/정책에 따라 서비스 제공

<br/> 

## 게임 서버의 종류
일반적으로 __웹서버, 게임서버__ 로 나눠어진다.

<br/> 

#### 웹 서버
- HTTP 서버 (테크아웃 포장 전문 식당) (aka.HTTP Server)  
- 손님이 음식을 받아서 떠나면, 그 이후로 연락이 끊긴다.
- 질의/응답 형태
- 주로 드물게 정보를 요청/갱신할때 사용한다
- 실시간 Interaction(상호작용)이 필요하지 않다.
- 식당에서 손님한테 먼저 접근할 일이 없다. (물을 따라드릴까요? <- NO)
- 주문 후 손님이 떠나면, 손님의 상태를 당분간 잊고 지낸다. (Stateless)
- 모든 언어는 자기만의 프레임 워크를 가지고 있다 (C# 은 대표적으로 ASP.NET)
- __대표적인 예시__ __(게임 랭킹)__

<br/> 

#### 게임 서버
- TCP 서버 (일반 식당), 바이너리 서버(aka. TCP Server, Binary Sever, Stateful Sever...)
- 서빙 직원이 와서 손님에게 물어볼 수도 있고
- 손님이 추가 주문을 하기도 하고
- 실시간 Interaction이 있다.
- 요청/ 갱신 횟수가 많다.
- 언제라도 직원이 손님한테 접근이 가능해야한다.
- 손님이 식당에 머무는 동안, 손님의 상태를 보며 최상의 서비스를 제공한다 (Stateful)
- 웹과는 달리 최적화된 프레임 워크라는 것이 존재하지 않는다.
- __대표적인 예시__ __(채팅, 스킬 사용 여부 등)__
 
<img src= "https://github.com/JiHyeokHeo/CsharpServer/assets/125938592/ca453f35-bdd3-49f8-833a-b9a568506ff3" width="600" height="200"/>

## 멀티쓰레드
- 직원들을 고용하고 운영하는 것

<img src= "https://github.com/JiHyeokHeo/CsharpServer/assets/125938592/c56b2846-292e-41bc-af61-a5947cbe5e0f" width="600" height="200"/>
<br/> <br/> 
<img src= "https://github.com/JiHyeokHeo/CsharpServer/assets/125938592/cf1d7d0e-25cc-4903-b0c2-4cbaa380e0ef" width="600" height="200"/>
<br/> <br/> 

- 커널 모드 (윈도우즈의 핵심적인 내용들이 작동되는 부분이다)
- 모든 프로그램들을 똑같은 시간으로 분배할 필요가 없다.  
  우리는 원하는 대로 분배를 할 수 있는데 이를 __스케줄링__ 이라 한다.
- 이는 __싱글코어__ 를 기준인 예시이다.
<img src= "https://github.com/JiHyeokHeo/CsharpServer/assets/125938592/6fa788df-992f-4920-ac41-6fd3fd19b752" width="600" height="200"/>
 
<br/> <br/> 

- 하지만 몰아서 실행하게 되면 다른쪽은 실행이 잘 안되는 현상이 발생하는데  
  이를 __기아현상__ 이라 한다.
<img src= "https://github.com/JiHyeokHeo/CsharpServer/assets/125938592/39eefddb-3d6a-4a01-be74-7fa8adfd6f7a" width="600" height="200"/>

<br/> <br/> 
- 싱글 코어를 계속해서 발전해왔지만 발열 문제(물리적 문제)로 인해 다중코어를 사용하는 방식을 채택했다.
- CPU 에 코어를 늘리는 방식으로 발전이 되어왔다. (2, 4, 8개 ...)
- 하지만 쓰레드를 무작정 늘리게 되면 다른 쓰레드로 옮겨타는 것이 코스트가 높기떄문에 성능이 오히려 떨어질 수 있다.
- 최대 효율은 코어수 = 쓰레드 수 이다.
<img src= "https://github.com/JiHyeokHeo/CsharpServer/assets/125938592/676ad5d0-d226-4bf9-bdc2-bc6e2736fb23" width="600" height="200"/>

<br/> <br/> 

- 이는 멀티쓰레드를 사용 시 데이터들이 공유되는 예시이다.
- Stack 영역은 쓰레드별로 관리하기 때문에 괜찮으나 Heap 영역과 Data 영역은 공유한다.
<img src= "https://github.com/JiHyeokHeo/CsharpServer/assets/125938592/c02ccc4f-0feb-444b-b384-5149800329a5" width="600" height="300"/>


## 네트워크
- 직원들이 손님과 어떤 방식으로 대화를 할지

## DB
- 결제 및 장부 처리를 어떤 방식으로 할지

## 게임 로직
- 손님들의 주문을 신속하고 맛있게 요리하는 것

## 서버 구조
- 위에서 정한 정책에 맞는 식당의 인테리어에 대해 고민하는 것
